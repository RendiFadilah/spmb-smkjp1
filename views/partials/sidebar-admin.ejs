<!-- Navigation Menu -->
<div class="space-y-6">
    <!-- Main -->
    <div>
        <p class="px-3 mb-2 text-[10px] font-bold uppercase tracking-[0.15em] text-slate-500">Menu Utama</p>
        <div class="space-y-0.5">
            <a href="/dashboard/admin" class="flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium transition-all duration-200 group
                <%= currentPath === '/dashboard/admin' ? 'bg-brand-600 text-white shadow-lg shadow-brand-500/25' : 'text-slate-300 hover:bg-white/[0.06] hover:text-white' %>">
                <div class="w-8 h-8 rounded-lg flex items-center justify-center shrink-0 transition-colors
                    <%= currentPath === '/dashboard/admin' ? 'bg-white/20' : 'bg-white/[0.04] group-hover:bg-white/[0.08]' %>">
                    <i class="fas fa-th-large text-xs"></i>
                </div>
                <span>Dashboard</span>
            </a>
        </div>
    </div>

    <!-- Data Management -->
    <div>
        <p class="px-3 mb-2 text-[10px] font-bold uppercase tracking-[0.15em] text-slate-500">Manajemen Data</p>
        <div class="space-y-0.5">
            <% if (user.roles === 'Admin') { %>
            <!-- Manajemen Petugas -->
            <a href="/dashboard/admin/petugas" class="flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium transition-all duration-200 group
                <%= currentPath === '/dashboard/admin/petugas' ? 'bg-brand-600 text-white shadow-lg shadow-brand-500/25' : 'text-slate-300 hover:bg-white/[0.06] hover:text-white' %>">
                <div class="w-8 h-8 rounded-lg flex items-center justify-center shrink-0 transition-colors
                    <%= currentPath === '/dashboard/admin/petugas' ? 'bg-white/20' : 'bg-white/[0.04] group-hover:bg-white/[0.08]' %>">
                    <i class="fas fa-user-tie text-xs"></i>
                </div>
                <span>Manajemen Petugas</span>
            </a>

            <!-- Manajemen Jurusan -->
            <a href="/dashboard/admin/jurusan" class="flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium transition-all duration-200 group
                <%= currentPath === '/dashboard/admin/jurusan' ? 'bg-brand-600 text-white shadow-lg shadow-brand-500/25' : 'text-slate-300 hover:bg-white/[0.06] hover:text-white' %>">
                <div class="w-8 h-8 rounded-lg flex items-center justify-center shrink-0 transition-colors
                    <%= currentPath === '/dashboard/admin/jurusan' ? 'bg-white/20' : 'bg-white/[0.04] group-hover:bg-white/[0.08]' %>">
                    <i class="fas fa-graduation-cap text-xs"></i>
                </div>
                <span>Manajemen Jurusan</span>
            </a>

            <!-- Manajemen Biaya (Dropdown) -->
            <div class="sidebar-dropdown">
                <button type="button" onclick="toggleSidebarDropdown('biaya')" class="w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium transition-all duration-200 group
                    <%= currentPath.startsWith('/dashboard/admin/biaya') || currentPath.startsWith('/dashboard/admin/periode') || currentPath.startsWith('/dashboard/admin/diskon') ? 'bg-white/[0.08] text-white' : 'text-slate-300 hover:bg-white/[0.06] hover:text-white' %>">
                    <div class="w-8 h-8 rounded-lg flex items-center justify-center shrink-0 transition-colors
                        <%= currentPath.startsWith('/dashboard/admin/biaya') || currentPath.startsWith('/dashboard/admin/periode') || currentPath.startsWith('/dashboard/admin/diskon') ? 'bg-brand-500/20' : 'bg-white/[0.04] group-hover:bg-white/[0.08]' %>">
                        <i class="fas fa-coins text-xs"></i>
                    </div>
                    <span class="flex-1 text-left">Manajemen Biaya</span>
                    <i class="fas fa-chevron-down text-[10px] text-slate-400 transition-transform duration-200" id="biaya-chevron"></i>
                </button>
                <div id="biaya-submenu" class="sidebar-submenu ml-[44px] mt-1 space-y-0.5">
                    <a href="/dashboard/admin/biaya" class="block px-3 py-2 rounded-lg text-[13px] transition-all duration-200
                        <%= currentPath === '/dashboard/admin/biaya' ? 'text-brand-400 bg-brand-500/10 font-semibold' : 'text-slate-400 hover:text-white hover:bg-white/[0.04]' %>">
                        Master Biaya
                    </a>
                    <a href="/dashboard/admin/periode" class="block px-3 py-2 rounded-lg text-[13px] transition-all duration-200
                        <%= currentPath === '/dashboard/admin/periode' ? 'text-brand-400 bg-brand-500/10 font-semibold' : 'text-slate-400 hover:text-white hover:bg-white/[0.04]' %>">
                        Periode Pendaftaran
                    </a>
                    <a href="/dashboard/admin/diskon" class="block px-3 py-2 rounded-lg text-[13px] transition-all duration-200
                        <%= currentPath === '/dashboard/admin/diskon' ? 'text-brand-400 bg-brand-500/10 font-semibold' : 'text-slate-400 hover:text-white hover:bg-white/[0.04]' %>">
                        Diskon Periode
                    </a>
                </div>
            </div>
            <% } %>

            <!-- Manajemen CPDB (Dropdown) -->
            <% if (user.roles === 'Admin' || user.roles === 'Petugas') { %>
            <div class="sidebar-dropdown">
                <button type="button" onclick="toggleSidebarDropdown('cpdb')" class="w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium transition-all duration-200 group
                    <%= currentPath.startsWith('/dashboard/admin/cpdb') ? 'bg-white/[0.08] text-white' : 'text-slate-300 hover:bg-white/[0.06] hover:text-white' %>">
                    <div class="w-8 h-8 rounded-lg flex items-center justify-center shrink-0 transition-colors
                        <%= currentPath.startsWith('/dashboard/admin/cpdb') ? 'bg-brand-500/20' : 'bg-white/[0.04] group-hover:bg-white/[0.08]' %>">
                        <i class="fas fa-users text-xs"></i>
                    </div>
                    <span class="flex-1 text-left">Manajemen CPDB</span>
                    <i class="fas fa-chevron-down text-[10px] text-slate-400 transition-transform duration-200" id="cpdb-chevron"></i>
                </button>
                <div id="cpdb-submenu" class="sidebar-submenu ml-[44px] mt-1 space-y-0.5">
                    <a href="/dashboard/admin/cpdb-awal" class="block px-3 py-2 rounded-lg text-[13px] transition-all duration-200
                        <%= currentPath === '/dashboard/admin/cpdb-awal' ? 'text-brand-400 bg-brand-500/10 font-semibold' : 'text-slate-400 hover:text-white hover:bg-white/[0.04]' %>">
                        CPDB Awal
                    </a>
                    <a href="/dashboard/admin/cpdb-tetap" class="block px-3 py-2 rounded-lg text-[13px] transition-all duration-200
                        <%= currentPath === '/dashboard/admin/cpdb-tetap' ? 'text-brand-400 bg-brand-500/10 font-semibold' : 'text-slate-400 hover:text-white hover:bg-white/[0.04]' %>">
                        CPDB Tetap
                    </a>
                </div>
            </div>
            <% } %>

            <!-- Manajemen Formulir (Dropdown) -->
            <% if (user.roles === 'Admin' || user.roles === 'Petugas' || user.roles === 'Bendahara') { %>
            <div class="sidebar-dropdown">
                <button type="button" onclick="toggleSidebarDropdown('formulir')" class="w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium transition-all duration-200 group
                    <%= currentPath.startsWith('/dashboard/admin/formulir') ? 'bg-white/[0.08] text-white' : 'text-slate-300 hover:bg-white/[0.06] hover:text-white' %>">
                    <div class="w-8 h-8 rounded-lg flex items-center justify-center shrink-0 transition-colors
                        <%= currentPath.startsWith('/dashboard/admin/formulir') ? 'bg-brand-500/20' : 'bg-white/[0.04] group-hover:bg-white/[0.08]' %>">
                        <i class="fas fa-file-lines text-xs"></i>
                    </div>
                    <span class="flex-1 text-left">Manajemen Formulir</span>
                    <i class="fas fa-chevron-down text-[10px] text-slate-400 transition-transform duration-200" id="formulir-chevron"></i>
                </button>
                <div id="formulir-submenu" class="sidebar-submenu ml-[44px] mt-1 space-y-0.5">
                    <% if (user.roles === 'Admin') { %>
                    <a href="/dashboard/admin/formulir/kode-pembayaran" class="block px-3 py-2 rounded-lg text-[13px] transition-all duration-200
                        <%= currentPath === '/dashboard/admin/formulir/kode-pembayaran' ? 'text-brand-400 bg-brand-500/10 font-semibold' : 'text-slate-400 hover:text-white hover:bg-white/[0.04]' %>">
                        Kode Pembayaran
                    </a>
                    <% } %>
                    <a href="/dashboard/admin/formulir" class="block px-3 py-2 rounded-lg text-[13px] transition-all duration-200
                        <%= currentPath === '/dashboard/admin/formulir' ? 'text-brand-400 bg-brand-500/10 font-semibold' : 'text-slate-400 hover:text-white hover:bg-white/[0.04]' %>">
                        Formulir
                    </a>
                </div>
            </div>
            <% } %>

            <!-- Data Pembayaran -->
            <% if (user.roles === 'Admin' || user.roles === 'Bendahara') { %>
            <a href="/dashboard/admin/pembayaran" class="flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium transition-all duration-200 group
                <%= currentPath === '/dashboard/admin/pembayaran' ? 'bg-brand-600 text-white shadow-lg shadow-brand-500/25' : 'text-slate-300 hover:bg-white/[0.06] hover:text-white' %>">
                <div class="w-8 h-8 rounded-lg flex items-center justify-center shrink-0 transition-colors
                    <%= currentPath === '/dashboard/admin/pembayaran' ? 'bg-white/20' : 'bg-white/[0.04] group-hover:bg-white/[0.08]' %>">
                    <i class="fas fa-credit-card text-xs"></i>
                </div>
                <span>Data Pembayaran</span>
            </a>
            <% } %>

            <!-- Reward SPMB -->
            <% if (user.roles === 'Admin' || user.roles === 'Bendahara') { %>
            <a href="/dashboard/admin/reward-spmb" class="flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium transition-all duration-200 group
                <%= currentPath === '/dashboard/admin/reward-spmb' ? 'bg-brand-600 text-white shadow-lg shadow-brand-500/25' : 'text-slate-300 hover:bg-white/[0.06] hover:text-white' %>">
                <div class="w-8 h-8 rounded-lg flex items-center justify-center shrink-0 transition-colors
                    <%= currentPath === '/dashboard/admin/reward-spmb' ? 'bg-white/20' : 'bg-white/[0.04] group-hover:bg-white/[0.08]' %>">
                    <i class="fas fa-gift text-xs"></i>
                </div>
                <span>Reward SPMB</span>
            </a>
            <% } %>

            <!-- Manajemen Seragam -->
            <% if (user.roles === 'Admin' || user.roles === 'Petugas') { %>
            <a href="/dashboard/admin/seragam" class="flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium transition-all duration-200 group
                <%= currentPath === '/dashboard/admin/seragam' ? 'bg-brand-600 text-white shadow-lg shadow-brand-500/25' : 'text-slate-300 hover:bg-white/[0.06] hover:text-white' %>">
                <div class="w-8 h-8 rounded-lg flex items-center justify-center shrink-0 transition-colors
                    <%= currentPath === '/dashboard/admin/seragam' ? 'bg-white/20' : 'bg-white/[0.04] group-hover:bg-white/[0.08]' %>">
                    <i class="fas fa-shirt text-xs"></i>
                </div>
                <span>Manajemen Seragam</span>
            </a>
            <% } %>
        </div>
    </div>

    <!-- Settings -->
    <% if (user.roles === 'Admin') { %>
    <div>
        <p class="px-3 mb-2 text-[10px] font-bold uppercase tracking-[0.15em] text-slate-500">Pengaturan</p>
        <div class="space-y-0.5">
            <a href="/dashboard/admin/settings" class="flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium transition-all duration-200 group
                <%= currentPath === '/dashboard/admin/settings' ? 'bg-brand-600 text-white shadow-lg shadow-brand-500/25' : 'text-slate-300 hover:bg-white/[0.06] hover:text-white' %>">
                <div class="w-8 h-8 rounded-lg flex items-center justify-center shrink-0 transition-colors
                    <%= currentPath === '/dashboard/admin/settings' ? 'bg-white/20' : 'bg-white/[0.04] group-hover:bg-white/[0.08]' %>">
                    <i class="fas fa-gear text-xs"></i>
                </div>
                <span>Pengaturan</span>
            </a>
        </div>
    </div>
    <% } %>
</div>

<script>
function toggleSidebarDropdown(name) {
    const submenu = document.getElementById(name + '-submenu');
    const chevron = document.getElementById(name + '-chevron');
    if (!submenu) return;

    // Close other dropdowns
    document.querySelectorAll('.sidebar-submenu').forEach(el => {
        if (el.id !== name + '-submenu' && el.classList.contains('open')) {
            el.classList.remove('open');
            const otherId = el.id.replace('-submenu', '-chevron');
            const otherChevron = document.getElementById(otherId);
            if (otherChevron) otherChevron.style.transform = '';
        }
    });

    const isOpen = submenu.classList.contains('open');
    if (isOpen) {
        submenu.classList.remove('open');
        if (chevron) chevron.style.transform = '';
    } else {
        submenu.classList.add('open');
        if (chevron) chevron.style.transform = 'rotate(180deg)';
    }
}

// Auto open active dropdowns
document.addEventListener('DOMContentLoaded', () => {
    const path = window.location.pathname;
    if (path.startsWith('/dashboard/admin/cpdb')) toggleSidebarDropdown('cpdb');
    if (path.startsWith('/dashboard/admin/formulir')) toggleSidebarDropdown('formulir');
    if (path.startsWith('/dashboard/admin/biaya') || path.startsWith('/dashboard/admin/periode') || path.startsWith('/dashboard/admin/diskon')) toggleSidebarDropdown('biaya');
});

function confirmLogout() {
    Swal.fire({
        title: 'Konfirmasi Logout',
        text: 'Apakah Anda yakin ingin keluar?',
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#ef4444',
        cancelButtonColor: '#6366f1',
        confirmButtonText: 'Ya, Logout',
        cancelButtonText: 'Batal'
    }).then((result) => {
        if (result.isConfirmed) {
            document.getElementById('logoutFormSidebar').submit();
        }
    });
}
</script>
